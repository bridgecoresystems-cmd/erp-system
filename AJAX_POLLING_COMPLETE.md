# ‚úÖ AJAX POLLING –î–û–ë–ê–í–õ–ï–ù - –í–°–ï –°–¢–†–ê–ù–ò–¶–´ –û–ë–ù–û–í–õ–Ø–Æ–¢–°–Ø –ê–í–¢–û–ú–ê–¢–ò–ß–ï–°–ö–ò!

## üéâ –ß—Ç–æ –¥–æ–±–∞–≤–ª–µ–Ω–æ:

### 1. **–ù–æ–≤—ã–µ API endpoints**
- `/lohia/api/maintenance-history/` - –¥–ª—è –∏—Å—Ç–æ—Ä–∏–∏ –≤—ã–∑–æ–≤–æ–≤ –º–∞—Å—Ç–µ—Ä–∞
- `/lohia/api/shifts-history/` - –¥–ª—è –∏—Å—Ç–æ—Ä–∏–∏ —Å–º–µ–Ω
- `/lohia/api/dashboard-status/` - –¥–ª—è –¥–∞—à–±–æ—Ä–¥–∞ (—É–∂–µ –±—ã–ª)

### 2. **AJAX polling –Ω–∞ –≤—Å–µ—Ö —Å—Ç—Ä–∞–Ω–∏—Ü–∞—Ö**
- **Dashboard** (`/lohia/dashboard/`) - –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –∫–∞–∂–¥—ã–µ 5 —Å–µ–∫—É–Ω–¥ ‚úÖ
- **Maintenance History** (`/lohia/maintenance/`) - –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –∫–∞–∂–¥—ã–µ 5 —Å–µ–∫—É–Ω–¥ ‚úÖ **–ù–û–í–û–ï!**
- **Shifts History** (`/lohia/shifts/`) - –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –∫–∞–∂–¥—ã–µ 5 —Å–µ–∫—É–Ω–¥ ‚úÖ **–ù–û–í–û–ï!**

### 3. **–î–æ–±–∞–≤–ª–µ–Ω—ã –º–µ—Ç–æ–¥—ã –≤ –º–æ–¥–µ–ª–∏**
- `MaintenanceCall.get_response_time_display()` - –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ —Ä–µ–∞–∫—Ü–∏–∏ –≤ —Ñ–æ—Ä–º–∞—Ç–µ MM:SS
- `MaintenanceCall.get_repair_time_display()` - –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ —Ä–µ–º–æ–Ω—Ç–∞ –≤ —Ñ–æ—Ä–º–∞—Ç–µ MM:SS  
- `Shift.get_duration_display()` - –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Å–º–µ–Ω—ã –≤ —Ñ–æ—Ä–º–∞—Ç–µ HH:MM

## üöÄ –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:

### **Maintenance History** (–ò—Å—Ç–æ—Ä–∏—è –≤—ã–∑–æ–≤–æ–≤ –º–∞—Å—Ç–µ—Ä–∞):
```javascript
// –û–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –∫–∞–∂–¥—ã–µ 5 —Å–µ–∫—É–Ω–¥
function updateMaintenanceHistory() {
    fetch('/lohia/api/maintenance-history/')
        .then(response => response.json())
        .then(data => {
            // –û–±–Ω–æ–≤–ª—è–µ—Ç —Ç–∞–±–ª–∏—Ü—É —Å –≤—ã–∑–æ–≤–∞–º–∏ –º–∞—Å—Ç–µ—Ä–∞
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å—Ç–∞—Ç—É—Å: –û–∂–∏–¥–∞–µ—Ç/–í —Ä–∞–±–æ—Ç–µ/–ó–∞–≤–µ—Ä—à–µ–Ω
            // –í—Ä–µ–º—è —Ä–µ–∞–∫—Ü–∏–∏ –∏ —Ä–µ–º–æ–Ω—Ç–∞ –≤ —Ñ–æ—Ä–º–∞—Ç–µ MM:SS
        });
}
```

### **Shifts History** (–ò—Å—Ç–æ—Ä–∏—è —Å–º–µ–Ω):
```javascript
// –û–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –∫–∞–∂–¥—ã–µ 5 —Å–µ–∫—É–Ω–¥  
function updateShiftsHistory() {
    fetch('/lohia/api/shifts-history/')
        .then(response => response.json())
        .then(data => {
            // –û–±–Ω–æ–≤–ª—è–µ—Ç —Ç–∞–±–ª–∏—Ü—É —Å–æ —Å–º–µ–Ω–∞–º–∏
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å—Ç–∞—Ç—É—Å: –ê–∫—Ç–∏–≤–Ω–∞/–ó–∞–≤–µ—Ä—à–µ–Ω–∞
            // –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≤ —Ñ–æ—Ä–º–∞—Ç–µ HH:MM
        });
}
```

## üìä –ü—Ä–∏–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö API:

### Maintenance History API:
```json
{
  "success": true,
  "calls": [
    {
      "id": 9,
      "call_time": "02.10.2025 11:49:33",
      "operator": "Akmuradow Batyr Muhamednazarowich",
      "master": "–ú–∞—Å—Ç–µ—Ä–æ–≤ –ü–µ—Ç—Ä",
      "status": "–ó–∞–≤–µ—Ä—à–µ–Ω",
      "response_time": "2:19",
      "repair_time": "0:05"
    }
  ]
}
```

### Shifts History API:
```json
{
  "success": true,
  "shifts": [
    {
      "id": 19,
      "start_time": "02.10.2025 11:31:33",
      "end_time": "–ê–∫—Ç–∏–≤–Ω–∞",
      "operator": "Akmuradow Batyr Muhamednazarowich",
      "duration": "0:33",
      "total_pulses": 0,
      "total_meters": 0.0,
      "status": "–ê–∫—Ç–∏–≤–Ω–∞"
    }
  ]
}
```

## üéØ –ß—Ç–æ —Ç–µ–ø–µ—Ä—å –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏:

### **Dashboard** (`/lohia/dashboard/`):
- ‚úÖ –°—Ç–∞—Ç—É—Å —Å—Ç–∞–Ω–∫–∞ (—Ä–∞–±–æ—Ç–∞–µ—Ç/–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω/–≤ —Ä–µ–º–æ–Ω—Ç–µ)
- ‚úÖ –¢–µ–∫—É—â–∏–π –æ–ø–µ—Ä–∞—Ç–æ—Ä
- ‚úÖ –°—á–µ—Ç—á–∏–∫ –∏–º–ø—É–ª—å—Å–æ–≤ –∏ –º–µ—Ç—Ä–∞–∂–∞
- ‚úÖ –ê–∫—Ç–∏–≤–Ω—ã–µ –≤—ã–∑–æ–≤—ã –º–∞—Å—Ç–µ—Ä–∞ —Å —Ç–∞–π–º–µ—Ä–æ–º

### **Maintenance History** (`/lohia/maintenance/`):
- ‚úÖ –ù–æ–≤—ã–µ –≤—ã–∑–æ–≤—ã –º–∞—Å—Ç–µ—Ä–∞ –ø–æ—è–≤–ª—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- ‚úÖ –°—Ç–∞—Ç—É—Å –º–µ–Ω—è–µ—Ç—Å—è: –û–∂–∏–¥–∞–µ—Ç ‚Üí –í —Ä–∞–±–æ—Ç–µ ‚Üí –ó–∞–≤–µ—Ä—à–µ–Ω
- ‚úÖ –í—Ä–µ–º—è —Ä–µ–∞–∫—Ü–∏–∏ –∏ —Ä–µ–º–æ–Ω—Ç–∞ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

### **Shifts History** (`/lohia/shifts/`):
- ‚úÖ –ù–æ–≤—ã–µ —Å–º–µ–Ω—ã –ø–æ—è–≤–ª—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- ‚úÖ –ê–∫—Ç–∏–≤–Ω—ã–µ —Å–º–µ–Ω—ã –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç —Ç–µ–∫—É—â—É—é –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- ‚úÖ –°—Ç–∞—Ç—É—Å –º–µ–Ω—è–µ—Ç—Å—è: –ê–∫—Ç–∏–≤–Ω–∞ ‚Üí –ó–∞–≤–µ—Ä—à–µ–Ω–∞

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏:

### –ß–∞—Å—Ç–æ—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:
- **–í—Å–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã**: –∫–∞–∂–¥—ã–µ 5 —Å–µ–∫—É–Ω–¥
- **–ü–µ—Ä–≤–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ**: —á–µ—Ä–µ–∑ 2 —Å–µ–∫—É–Ω–¥—ã –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫:
- –í—Å–µ AJAX –∑–∞–ø—Ä–æ—Å—ã –∏–º–µ—é—Ç –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫
- –ü—Ä–∏ –æ—à–∏–±–∫–µ –≤—ã–≤–æ–¥–∏—Ç—Å—è —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:
- API –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 20 –∑–∞–ø–∏—Å–µ–π
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `select_related()` –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ –ë–î
- –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä

## üéâ –†–µ–∑—É–ª—å—Ç–∞—Ç:
–¢–µ–ø–µ—Ä—å –í–°–ï —Å—Ç—Ä–∞–Ω–∏—Ü—ã —Å–∏—Å—Ç–µ–º—ã –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ Lohia –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏! 
–ù–µ –Ω—É–∂–Ω–æ –Ω–∞–∂–∏–º–∞—Ç—å F5 - –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –ø—Ä–∏—Ö–æ–¥—è—Ç —Å–∞–º–∏ –∫–∞–∂–¥—ã–µ 5 —Å–µ–∫—É–Ω–¥! üöÄ
