{% load group_filters %}
{% load static %}
<!DOCTYPE html>
<html>
<head>
    <title>{% block title %}{% endblock %}</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico">
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
</head>
<body>
    <div class="header">
        <div class="header-left">
            <img src="{% static 'images/logo.png' %}" alt="Logo" class="logo-menu-title">
            
            {% if user.is_authenticated %}
                <div class="nav-links" id="navLinks">
                    <!-- Mobile user info -->
                    <div class="mobile-user-info">
                        <div class="mobile-user-avatar">
                            {% if user.employee_profile %}
                                {% if user.employee_profile.photo %}
                                    <img src="{{ user.employee_profile.photo.url }}" alt="{{ user.username }}" style="width: 100%; height: 100%; object-fit: cover;">
                                {% else %}
                                    <span class="avatar-placeholder">üë§</span>
                                {% endif %}
                            {% else %}
                                <span class="avatar-placeholder">üë§</span>
                            {% endif %}
                        </div>
                        <div class="mobile-user-details">
                            <div class="mobile-username">{{ user.username }}</div>
                            {% if user.groups.all %}
                                <div class="mobile-user-groups">
                                    {% for group in user.groups.all %}
                                        <small class="mobile-group-badge">{{ group.name }}</small>
                                    {% endfor %}
                                </div>
                            {% endif %}
                        </div>
                    </div>
                    
                    <!-- Logout button for mobile -->
                    <div class="mobile-logout">
                        <form action="/logout/" method="post" style="display: inline;">
                            {% csrf_token %}
                            <button type="submit" class="mobile-logout-btn">üö™ –í—ã—Ö–æ–¥</button>
                        </form>
                    </div>
                    
                    <a href="{% url 'home' %}">–ì–ª–∞–≤–Ω–∞—è</a>
                    
                    {% if user.is_superuser %}
                        <!-- –°—É–ø–µ—Ä–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç –≤—Å–µ -->
                        <div class="dropdown">
                            <a href="#">–°–æ—Ç—Ä—É–¥–Ω–∏–∫–∏</a>
                            <div class="dropdown-content">
                                <a href="{% url 'employees:employee_list' %}">–°–ø–∏—Å–æ–∫ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤</a>
                                <a href="{% url 'employees:employee_add' %}">–î–æ–±–∞–≤–∏—Ç—å —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞</a>
                            </div>
                        </div>
                        <a href="{% url 'employees:worktime_list' %}">–†–∞–±–æ—á–µ–µ –≤—Ä–µ–º—è</a>
                        <div class="dropdown">
                            <a href="#">üõ°Ô∏è –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å</a>
                            <div class="dropdown-content">
                                <a href="{% url 'security:dashboard' %}">–ü–∞–Ω–µ–ª—å –æ—Ö—Ä–∞–Ω—ã</a>
                                <a href="{% url 'security:logs_report' %}">–û—Ç—á–µ—Ç—ã</a>

                            </div>
                        </div>
                        
                        <div class="dropdown">
                            <a href="#">–û—Ç—á–µ—Ç—ã</a>
                            <div class="dropdown-content">
                                <a href="#">–ü–æ –≤—Ä–µ–º–µ–Ω–∏</a>
                                <a href="#">–ü–æ –æ—Ç–¥–µ–ª–∞–º</a>
                                <a href="#">–≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö</a>
                            </div>
                        </div>
                        <div class="dropdown">
                            <a href="#">üè≠ –°—Ç–∞–Ω–æ–∫ Lohia</a>
                            <div class="dropdown-content">
                                <a href="{% url 'lohia_monitor:dashboard' %}">–î–∞—à–±–æ—Ä–¥</a>
                                <a href="{% url 'lohia_monitor:shifts_history' %}">–ò—Å—Ç–æ—Ä–∏—è —Å–º–µ–Ω</a>
                                <a href="{% url 'lohia_monitor:maintenance_history' %}">–í—ã–∑–æ–≤—ã –º–∞—Å—Ç–µ—Ä–∞</a>
                                <a href="{% url 'lohia_monitor:machine_stats' %}">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</a>
                            </div>
                        </div>
                        
                    {% elif user.groups.all|length > 0 %}
                        <!-- –ü—Ä–æ–≤–µ—Ä—è–µ–º –≥—Ä—É–ø–ø—É Director (–ù–∞—á–∞–ª—å–Ω–∏–∫) -->
                        {% for group in user.groups.all %}
                            {% if group.name == "Director" %}
                                <!-- –ù–∞—á–∞–ª—å–Ω–∏–∫ –≤–∏–¥–∏—Ç –≤—Å–µ –º–æ–¥—É–ª–∏ -->
                                <div class="dropdown">
                                    <a href="#">üë• –°–æ—Ç—Ä—É–¥–Ω–∏–∫–∏</a>
                                    <div class="dropdown-content">
                                        <a href="{% url 'employees:employee_list' %}">–°–ø–∏—Å–æ–∫ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤</a>
                                        <a href="{% url 'employees:employee_add' %}">–î–æ–±–∞–≤–∏—Ç—å —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞</a>
                                    </div>
                                </div>
                                <a href="{% url 'employees:worktime_list' %}">‚è∞ –†–∞–±–æ—á–µ–µ –≤—Ä–µ–º—è</a>
                                <div class="dropdown">
                                    <a href="#">üõ°Ô∏è –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å</a>
                                    <div class="dropdown-content">
                                        <a href="{% url 'security:dashboard' %}">–ü–∞–Ω–µ–ª—å –æ—Ö—Ä–∞–Ω—ã</a>
                                        <a href="{% url 'security:logs_report' %}">–û—Ç—á–µ—Ç—ã –ø–æ –ª–æ–≥–∞–º</a>
                                        <a href="{% url 'security:export_excel' %}">–≠–∫—Å–ø–æ—Ä—Ç Excel</a>
                                    </div>
                                </div>
                                <div class="dropdown">
                                    <a href="#">üè≠ –°—Ç–∞–Ω–æ–∫ Lohia</a>
                                    <div class="dropdown-content">
                                        <a href="{% url 'lohia_monitor:dashboard' %}">–î–∞—à–±–æ—Ä–¥</a>
                                        <a href="{% url 'lohia_monitor:shifts_history' %}">–ò—Å—Ç–æ—Ä–∏—è —Å–º–µ–Ω</a>
                                        <a href="{% url 'lohia_monitor:maintenance_history' %}">–í—ã–∑–æ–≤—ã –º–∞—Å—Ç–µ—Ä–∞</a>
                                        <a href="{% url 'lohia_monitor:machine_stats' %}">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</a>
                                    </div>
                                </div>
                                <div class="dropdown">
                                    <a href="#">üìä –û—Ç—á–µ—Ç—ã</a>
                                    <div class="dropdown-content">
                                        <a href="#">–ü–æ –≤—Ä–µ–º–µ–Ω–∏</a>
                                        <a href="#">–ü–æ –æ—Ç–¥–µ–ª–∞–º</a>
                                        <a href="#">–≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö</a>
                                    </div>
                                </div>
                            {% endif %}
                        {% endfor %}
                        
                        <!-- –û—Å—Ç–∞–ª—å–Ω—ã–µ –≥—Ä—É–ø–ø—ã -->
                        {% for group in user.groups.all %}
                            {% if group.name == "HR_Admins" %}
                                <div class="dropdown">
                                    <a href="#">–°–æ—Ç—Ä—É–¥–Ω–∏–∫–∏</a>
                                    <div class="dropdown-content">
                                        <a href="{% url 'employees:employee_list' %}">–°–ø–∏—Å–æ–∫ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤</a>
                                        <a href="{% url 'employees:employee_add' %}">–î–æ–±–∞–≤–∏—Ç—å —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞</a>
                                    </div>
                                </div>
                                <a href="{% url 'employees:worktime_list' %}">–†–∞–±–æ—á–µ–µ –≤—Ä–µ–º—è</a>
                                <div class="dropdown">
                                    <a href="#">–û—Ç—á–µ—Ç—ã</a>
                                    <div class="dropdown-content">
                                        <a href="#">–ü–æ –≤—Ä–µ–º–µ–Ω–∏</a>
                                        <a href="#">–ü–æ –æ—Ç–¥–µ–ª–∞–º</a>
                                        <a href="#">–≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö</a>
                                    </div>
                                </div>
                                
                            {% elif group.name == "HR_Users" %}
                                <div class="dropdown">
                                    <a href="#">–°–æ—Ç—Ä—É–¥–Ω–∏–∫–∏</a>
                                    <div class="dropdown-content">
                                        <a href="{% url 'employees:employee_list' %}">–°–ø–∏—Å–æ–∫ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤</a>
                                        <a href="{% url 'employees:employee_add' %}">–î–æ–±–∞–≤–∏—Ç—å —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞</a>
                                    </div>
                                </div>
                                <a href="{% url 'employees:security_display' %}">–ö–æ–Ω—Ç—Ä–æ–ª—å –¥–æ—Å—Ç—É–ø–∞</a>
                                <div class="dropdown">
                                    <a href="#">–û—Ç—á–µ—Ç—ã</a>
                                    <div class="dropdown-content">
                                        <a href="#">–ü–æ –≤—Ä–µ–º–µ–Ω–∏</a>
                                        <a href="#">–ü–æ –æ—Ç–¥–µ–ª–∞–º</a>
                                    </div>
                                </div>
                                
                            {% elif group.name == "Security" %}
                                <div class="dropdown">
                                    <a href="#">üõ°Ô∏è –ü–∞–Ω–µ–ª—å –æ—Ö—Ä–∞–Ω—ã</a>
                                    <div class="dropdown-content">
                                        <a href="{% url 'security:dashboard' %}">–ì–ª–∞–≤–Ω–∞—è –ø–∞–Ω–µ–ª—å</a>
                                        <a href="{% url 'security:logs_report' %}">–û—Ç—á–µ—Ç—ã –ø–æ –ª–æ–≥–∞–º</a>
                                        <a href="{% url 'security:export_excel' %}">–≠–∫—Å–ø–æ—Ä—Ç Excel</a>
                                    </div>
                                </div>
                                <div class="dropdown">
                                    <a href="#">üìä –°–º–µ–Ω—ã</a>
                                    <div class="dropdown-content">
                                        <a href="{% url 'security:start_shift' %}">–ù–∞—á–∞—Ç—å —Å–º–µ–Ω—É</a>
                                        <a href="{% url 'security:end_shift' %}">–ó–∞–≤–µ—Ä—à–∏—Ç—å —Å–º–µ–Ω—É</a>
                                    </div>
                                </div>
                                
                            {% elif group.name == "Security_Users" %}
                                <a href="{% url 'employees:security_display' %}">–ö–æ–Ω—Ç—Ä–æ–ª—å –¥–æ—Å—Ç—É–ø–∞</a>
                                <div class="dropdown">
                                    <a href="#">üõ°Ô∏è –û—Ö—Ä–∞–Ω–∞</a>
                                    <div class="dropdown-content">
                                        <a href="{% url 'employees:security_display' %}">–°—Ç–∞—Ä–∞—è –ø–∞–Ω–µ–ª—å</a>
                                        <a href="{% url 'security:dashboard' %}">–ù–æ–≤–∞—è –ø–∞–Ω–µ–ª—å</a>
                                    </div>
                                </div>
                                
                            {% elif group.name == "Department_Managers" %}
                                <a href="{% url 'employees:employee_list' %}">–ú–æ–∏ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∏</a>
                                <a href="{% url 'employees:security_display' %}">–ö–æ–Ω—Ç—Ä–æ–ª—å –¥–æ—Å—Ç—É–ø–∞</a>
                            {% endif %}
                        {% endfor %}
                        
                    {% else %}
                        <!-- –î–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –±–µ–∑ –≥—Ä—É–ø–ø -->
                        <a href="{% url 'employees:employee_list' %}">–°–æ—Ç—Ä—É–¥–Ω–∏–∫–∏</a>
                        <a href="{% url 'employees:security_display' %}">–ö–æ–Ω—Ç—Ä–æ–ª—å –¥–æ—Å—Ç—É–ø–∞</a>
                    {% endif %}
                </div>
            {% endif %}
        </div>
        {% if user.is_authenticated %}
            <div class="header-right">
                <!-- Burger Menu Button for Mobile -->
                <button class="burger-menu" id="burgerMenu" aria-label="–û—Ç–∫—Ä—ã—Ç—å –º–µ–Ω—é">
                    <span></span>
                    <span></span>
                    <span></span>
                </button>
                
                <!-- Desktop user info with photo -->
                <div class="desktop-user-info">
                    <div class="desktop-user-avatar">
                        {% if user.employee_profile %}
                            {% if user.employee_profile.photo %}
                                <img src="{{ user.employee_profile.photo.url }}" alt="{{ user.username }}" style="width: 100%; height: 100%; object-fit: cover;">
                            {% else %}
                                <span class="desktop-avatar-placeholder">üë§</span>
                            {% endif %}
                        {% else %}
                            <span class="desktop-avatar-placeholder">üë§</span>
                        {% endif %}
                    </div>
                    <div class="desktop-user-details">
                        <span class="username">{{ user.username }}</span>
                        {% if user.groups.all %}
                            <span class="user-role">
                                {% for group in user.groups.all %}
                                    <small style="background: #3498db; color: white; padding: 2px 6px; border-radius: 10px; font-size: 11px;">
                                        {{ group.name }}
                                    </small>
                                {% endfor %}
                            </span>
                        {% endif %}
                    </div>
                </div>
                <form action="/logout/" method="post" class="desktop-logout">
                    {% csrf_token %}
                    <button type="submit">üö™ –í—ã—Ö–æ–¥</button>
                </form>
            </div>
        {% endif %}
    </div>
    
    <div class="container">
        <!-- –°–æ–æ–±—â–µ–Ω–∏—è Django -->
        {% if messages %}
            <div style="margin: 20px 0;">
                {% for message in messages %}
                    <div class="alert alert-{{ message.tags }}" style="
                        padding: 12px 16px;
                        border-radius: 8px;
                        margin-bottom: 10px;
                        font-weight: 500;
                        {% if message.tags == 'success' %}
                            background: #d4edda;
                            color: #155724;
                            border: 1px solid #c3e6cb;
                        {% elif message.tags == 'error' %}
                            background: #f8d7da;
                            color: #721c24;
                            border: 1px solid #f5c6cb;
                        {% elif message.tags == 'warning' %}
                            background: #fff3cd;
                            color: #856404;
                            border: 1px solid #ffeaa7;
                        {% else %}
                            background: #d1ecf1;
                            color: #0c5460;
                            border: 1px solid #bee5eb;
                        {% endif %}
                    ">
                        {% if message.tags == 'success' %}‚úÖ{% elif message.tags == 'error' %}‚ùå{% elif message.tags == 'warning' %}‚ö†Ô∏è{% else %}‚ÑπÔ∏è{% endif %} {{ message }}
                    </div>
                {% endfor %}
            </div>
        {% endif %}
        
        {% block content %}
        {% endblock %}
    </div>
    <footer class="footer">
        <div class="footer-container">
            <div class="footer-content">
                <!-- –ë—Ä–µ–Ω–¥–∏–Ω–≥ –∫–æ–º–ø–∞–Ω–∏–∏ -->
                <div class="footer-brand">
                    <div class="footer-logo">
                        <div style="display: flex; align-items: center; gap: 15px;">
                            <img src="{% static 'images/logo.png' %}" alt="BridgeCore SYSTEMS" class="footer-logo-img">
                            <span style="font-size: 18px; font-weight: 600; color: #ffffff;">BridgeCore<span class="brand-accent"> SYSTEMS</span></span>
                        </div>
                        <div class="brand-line"></div>
                    </div>
                    <p class="brand-description">
                        –ö–æ–º–ø–ª–µ–∫—Å–Ω—ã–µ ERP —Ä–µ—à–µ–Ω–∏—è –¥–ª—è —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ –±–∏–∑–Ω–µ—Å–∞. 
                        –ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å, –∫–∞—á–µ—Å—Ç–≤–æ –∏ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π –ø–æ–¥—Ö–æ–¥ –∫ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏.
                    </p>
                    <div class="company-badges">
                        <span class="badge">Enterprise Ready</span>
                        <span class="badge">24/7 Support</span>
                    </div>
                </div>
                
                <!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è -->
                <div class="footer-nav">
                    <h4>–°–∏—Å—Ç–µ–º–∞</h4>
                    <ul>
                        <li><a href=#>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–µ—Ä—Å–æ–Ω–∞–ª–æ–º</a></li>
                        <li><a href=#>–£—á–µ—Ç —Ä–∞–±–æ—á–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏</a></li>
                        <li><a href=#>–ö–æ–Ω—Ç—Ä–æ–ª—å –¥–æ—Å—Ç—É–ø–∞</a></li>
                        <li><a href="#">–û—Ç—á–µ—Ç–Ω–æ—Å—Ç—å</a></li>
                    </ul>
                </div>
                
                <!-- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ -->
                <div class="footer-support">
                    <h4>–ü–æ–¥–¥–µ—Ä–∂–∫–∞</h4>
                    <ul>
                        <li><a href="#">–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞</a></li>
                        <li><a href="#">–ë–∞–∑–∞ –∑–Ω–∞–Ω–∏–π</a></li>
                        <li><a href="#">–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API</a></li>
                        <li><a href="#">–û–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã</a></li>
                    </ul>
                </div>
                
                <!-- –ö–æ–Ω—Ç–∞–∫—Ç—ã -->
                <div class="footer-contact">
                    <h4>–ö–æ–Ω—Ç–∞–∫—Ç—ã</h4>
                    <div class="contact-info">
                        <div class="contact-item">
                            <span class="contact-icon">üìß</span>
                            <a href="mailto:support@bridgecore.tech" style="color: #ffffff; text-decoration: none;">support@bridgecore.tech</a>
                        </div>
                        <div class="contact-item">
                            <span class="contact-icon">üìû</span>
                            <span>+993 64 58 59 58</span>
                        </div>
                        <div class="contact-item">
                            <span class="contact-icon">üåê</span>
                            <a href="https://bridgecore.tech" 
                                style="color: #ffffff; text-decoration: none;" 
                                target="_blank">www.bridgecore.tech</a>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Copyright –∏ —Å—Ç–∞—Ç—É—Å -->
            <div class="footer-bottom">
                <div class="footer-left">
                    <p>&copy; 2025 BridgeCore SYSTEMS. –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã.</p>
                    <p class="version-info">–í–µ—Ä—Å–∏—è —Å–∏—Å—Ç–µ–º—ã: 2.1.4 | –ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ: {% now "d.m.Y" %}</p>
                </div>
                <div class="footer-right">
                    <div class="system-status">
                        <span class="status-indicator active"></span>
                        <span class="status-text">–°–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ</span>
                    </div>
                </div>
            </div>
        </div>
    </footer>
    

    <script>
        // Mobile Navigation Toggle
        document.addEventListener('DOMContentLoaded', function() {
            const burgerMenu = document.getElementById('burgerMenu');
            const navLinks = document.getElementById('navLinks');
            
            if (burgerMenu && navLinks) {
                burgerMenu.addEventListener('click', function() {
                    navLinks.classList.toggle('nav-active');
                    burgerMenu.classList.toggle('burger-active');
                });
                
                // Close menu when clicking on a link
                // Close menu when clicking on a regular link (not dropdown)
                const navLinksArray = navLinks.querySelectorAll('a:not(.dropdown > a)');
                navLinksArray.forEach(link => {
                    link.addEventListener('click', function() {
                        navLinks.classList.remove('nav-active');
                        burgerMenu.classList.remove('burger-active');
                    });
                });
                
                // Close menu when clicking on dropdown items
                const dropdownItems = navLinks.querySelectorAll('.dropdown-content a');
                dropdownItems.forEach(item => {
                    item.addEventListener('click', function() {
                        navLinks.classList.remove('nav-active');
                        burgerMenu.classList.remove('burger-active');
                    });
                });
                
                // Close menu when clicking outside
                document.addEventListener('click', function(event) {
                    if (!navLinks.contains(event.target) && !burgerMenu.contains(event.target)) {
                        navLinks.classList.remove('nav-active');
                        burgerMenu.classList.remove('burger-active');
                    }
                });
            }
            
            // Handle dropdown menus on mobile
            const dropdowns = document.querySelectorAll('.dropdown');
            dropdowns.forEach(dropdown => {
                const dropdownContent = dropdown.querySelector('.dropdown-content');
                const dropdownLink = dropdown.querySelector('a');
                
                if (dropdownLink && dropdownContent) {
                    dropdownLink.addEventListener('click', function(e) {
                        if (window.innerWidth <= 768) {
                            e.preventDefault();
                            dropdown.classList.toggle('dropdown-active');
                        }
                    });
                }
            });
        });
    </script>
</body>
</html>